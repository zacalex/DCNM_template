<div [@routerTransition]>
    <app-page-header [heading]="'RPM Manager'" [icon]="'fa-edit'"></app-page-header>

    <div class="row">
        <div class="col-lg-9">
            <div class="card mb-3">
                <div class="card-header">RPM Address</div>
                <div class="card-body table-responsive">

                    <input class="form-control" #addressInput>

                    <p class="help-block">Please type in absolute path.</p>
                    <button (click)="onAdd(addressInput.value)" class="btn btn-primary">add</button>
                    <p>

                    </p>
                </div>
            </div>
        </div>


        <div class="col-lg-3">

          <app-sideTable #switchTable></app-sideTable>

        </div>

    </div>
    <!-- /.row -->



    <div class="card">
      <div class="card-header">Result</div>
        <div class="card-body">
            <ngb-tabset>
                <ngb-tab title="Status">

                    <ng-template ngbTabContent>
                        <table class="table table-hover table-striped">
                            <thead>
                                <tr>

                                    <th>Switch IP</th>
                                    <th>rpm</th>
                                    <th>Status</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr *ngFor="let s of lb.rpmStatus">

                                    <td>{{s.ip}}</td>
                                    <td>{{s.rpm}}</td>
                                    <td>{{s.status}}</td>
                                </tr>

                            </tbody>
                        </table>
                    </ng-template>
                </ngb-tab>
                <ngb-tab title="Logs">

                    <ng-template ngbTabContent>
                        <code *ngFor="let log of lb.TabLogs">
                        <pre>
                          {{log | json}}
                        </pre>
                      </code>
                    </ng-template>
                </ngb-tab>
                <ngb-tab>
                    <ng-template ngbTabTitle>
                        <div (click)="checkRpms()">Switches' rpms</div>
                    </ng-template>
                    <ng-template ngbTabContent>
                        <div class="alert alert-success">
                            <strong>{{lb.status}}</strong>
                        </div>
                        <div class="card sm-4" *ngFor="let r of lb.TabRpmReports">
                            <div class="card-header">{{r.ip}}</div>
                            <div class="card-body table-responsive">
                                <table class="table table-hover table-striped">
                                    <thead>
                                        <tr>
                                            <th>name</th>
                                            <th>status</th>
                                            <td>
                                                action
                                            </td>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <tr *ngFor="let rpm of r.active">
                                            <td>{{rpm.package_id}}</td>
                                            <td>active</td>
                                            <td>
                                                <button (click)="deactiveRemove(rpm.package_id,r.ip)" class="btn btn-warning">deactive</button>
                                            </td>
                                        </tr>
                                        <tr *ngFor="let rpm of r.inactive">
                                            <td>{{rpm.package_id}}</td>
                                            <td>inactive</td>
                                            <td>
                                                <button (click)="onActive(rpm.package_id,r.ip)" class="btn btn-success">active</button>
                                            </td>
                                        </tr>

                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </ng-template>
                </ngb-tab>
            </ngb-tabset>
        </div>
    </div>

</div>
